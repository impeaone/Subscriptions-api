basePath: /api/v1
definitions:
  models.CalculateTotalResponse:
    description: Response with total cost calculation
    properties:
      currency:
        type: string
      filters:
        $ref: '#/definitions/models.FilterInfo'
      period:
        $ref: '#/definitions/models.PeriodInfo'
      success:
        type: boolean
      total:
        type: integer
    type: object
  models.CreateOrUpdateRequest:
    description: Request to create or update a subscription
    properties:
      end_date:
        type: string
      price:
        type: integer
      service_name:
        type: string
      start_date:
        type: string
      user_id:
        type: string
    type: object
  models.DeleteRequest:
    description: Request to delete a subscription
    properties:
      service_name:
        type: string
      user_id:
        type: string
    type: object
  models.ErrorResponse:
    description: Error response
    properties:
      error:
        type: string
      message:
        type: string
    type: object
  models.FilterInfo:
    properties:
      service_name:
        type: string
      user_id:
        type: string
    type: object
  models.HealthResponse:
    description: Health check response
    properties:
      service:
        example: user-api
        type: string
      status:
        example: ok
        type: string
      timestamp:
        example: "2024-01-15T10:30:00Z"
        type: string
      version:
        example: 1.0.0
        type: string
    type: object
  models.PeriodInfo:
    properties:
      end_month:
        type: string
      start_month:
        type: string
    type: object
  models.Subscription:
    description: Subscription information
    properties:
      created_at:
        type: string
      end_date:
        description: '"12-2025" или null'
        type: string
      price:
        type: integer
      service_name:
        type: string
      start_date:
        description: '"07-2025"'
        type: string
      updated_at:
        type: string
      user_id:
        type: string
    type: object
info:
  contact: {}
  description: API for managing user subscriptions with period-based calculations
  title: Subscription Management API
  version: "1.0"
paths:
  /api/v1/subscriptions:
    delete:
      consumes:
      - application/json
      description: Delete subscription by user ID and service name
      parameters:
      - description: Subscription identification
        in: body
        name: subscription
        required: true
        schema:
          $ref: '#/definitions/models.DeleteRequest'
      produces:
      - application/json
      responses:
        "204":
          description: Subscription deleted successfully
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Delete a subscription
      tags:
      - subscriptions
    get:
      consumes:
      - application/json
      description: Get subscription by user ID and service name
      parameters:
      - description: User ID (UUID)
        example: 60601fee-2bf1-4721-ae6f-7636e79a0cba
        in: query
        name: user_id
        required: true
        type: string
      - description: Service name
        example: Netflix
        in: query
        name: service_name
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Subscription'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Get a specific subscription
      tags:
      - subscriptions
    post:
      consumes:
      - application/json
      description: Create new subscription or update existing one (upsert operation)
      parameters:
      - description: Subscription data
        in: body
        name: subscription
        required: true
        schema:
          $ref: '#/definitions/models.CreateOrUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.Subscription'
        "201":
          description: Created
          schema:
            $ref: '#/definitions/models.Subscription'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Create or update a subscription
      tags:
      - subscriptions
  /api/v1/subscriptions/total:
    get:
      consumes:
      - application/json
      description: Calculate total cost of subscriptions for a given period with optional
        filters
      parameters:
      - description: Start month (MM-YYYY or YYYY-MM)
        example: 01-2024
        in: query
        name: start_month
        required: true
        type: string
      - description: End month (MM-YYYY or YYYY-MM)
        example: 12-2024
        in: query
        name: end_month
        required: true
        type: string
      - description: User ID for filtering (UUID)
        example: 60601fee-2bf1-4721-ae6f-7636e79a0cba
        in: query
        name: user_id
        type: string
      - description: Service name for filtering
        example: Netflix
        in: query
        name: service_name
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.CalculateTotalResponse'
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: Calculate total cost for a period
      tags:
      - analytics
  /api/v1/subscriptions/user/{id}:
    get:
      consumes:
      - application/json
      description: Get all subscriptions for a specific user
      parameters:
      - description: User ID (UUID)
        example: 60601fee-2bf1-4721-ae6f-7636e79a0cba
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/models.Subscription'
            type: array
        "400":
          description: Bad Request
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "404":
          description: Not Found
          schema:
            $ref: '#/definitions/models.ErrorResponse'
        "500":
          description: Internal Server Error
          schema:
            $ref: '#/definitions/models.ErrorResponse'
      summary: List all subscriptions for a user
      tags:
      - subscriptions
  /health:
    get:
      description: Check if API is running
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/models.HealthResponse'
      summary: Health check
      tags:
      - system
schemes:
- http
swagger: "2.0"
