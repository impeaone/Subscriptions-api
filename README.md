# ‚ú® Subscription Management API
REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–¥—Å—á—ë—Ç–æ–º —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥.

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–¥—Å—á—ë—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ –ª—é–±–æ–π –ø–µ—Ä–∏–æ–¥ –≤—Ä–µ–º–µ–Ω–∏
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –∏ –Ω–∞–∑–≤–∞–Ω–∏—é —Å–µ—Ä–≤–∏—Å–∞
- Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º UI
- –ì–æ—Ç–æ–≤—ã–π Docker –æ–±—Ä–∞–∑

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker
- Docker Compose

## üöÄ –ó–∞–ø—É—Å–∫
```bash
git clone https://github.com/impeaone/Subscriptions-api
cd Subscriptions-api
docker-compose up -d
```

## üì° –ß—Ç–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã:
<div align="center">

| –°–µ—Ä–≤–∏—Å        | URL                                       | –õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å      | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ        |
|---------------|-------------------------------------------|-------------------|-------------------|
| API –ø—Ä–ª–æ–∂–µ–Ω–∏–µ | http://localhost:11682                    | -                 | –û—Å–Ω–æ–≤–Ω–æ–µ REST API | 
| Swagger UI    | http://localhost:11682/swagger/index.html | -                 | –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API  | 
| PostgreSQL    | localhost:5432                            | postgres/postgres | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö       | 
| Adminer       | http://localhost:8080                     | postgres/postgres | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î     |
</div>

## üîå –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç 11682)
### Health Check
```text
GET    /health
```
### CRUD
### 1. –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
```text
GET /api/v1/subscriptions/?user_id=<uuid>&service_name=<string>
```
##### –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –Ω–∞–∑–≤–∞–Ω–∏—é —Å–µ—Ä–≤–∏—Å–∞.
##### –ü–∞—Ä–∞–º–µ—Ä—ã:
- ```user_id``` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ```service_name``` (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ù–∞–∑–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
### 2. –°–æ–∑–¥–∞—Ç—å/–û–±–Ω–æ–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
```text
POST /api/v1/subscriptions/
```
#### –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é.
#### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
    "service_name": "Yandex Plus",
    "price": 400,
    "user_id": "60601fee-2bf1-4721-ae6f-7636e79a0cba",
    "start_date": "01-2026"
}
```
### 3. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–æ–¥–ø–∏—Å–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```text
GET /api/v1/subscriptions/user/{user_id}
```
#### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å–æ–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### 4. –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
```text
DELETE /api/v1/subscriptions/
```
#### –£–¥–∞–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –ø–æ ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –Ω–∞–∑–≤–∞–Ω–∏—é —Å–µ—Ä–≤–∏—Å–∞.
#### –¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "service_name": "Yandex Plus",
  "user_id": "60601fee-2bf1-4721-ae6f-7636e79a0cba"
}
```
### –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
### 5. –ü–æ–¥—Å—á—ë—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤ –∑–∞ –ø–µ—Ä–∏–æ–¥
```text
GET /api/v1/subscriptions/total/?start_month=01-2026&end_month=12-2026&user_id=<uuid>&service_name=<string>
```
#### –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å —Å—É–º–º–∞—Ä–Ω—É—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–æ–∫ –∑–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥.
#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- start_month (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ù–∞—á–∞–ª–æ –ø–µ—Ä–∏–æ–¥–∞ (MM-YYYY)
- end_month (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ö–æ–Ω–µ—Ü –ø–µ—Ä–∏–æ–¥–∞
- user_id (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- service_name (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π) - –§–∏–ª—å—Ç—Ä –ø–æ —Å–µ—Ä–≤–∏—Å—É
#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
{
    "success": true,
    "total": 1200,
    "currency": "RUB",
    "period": {
        "start_month": "01-2026",
        "end_month": "12-2026"
    },
    "filters": {
        "user_id": "60601fee-2bf1-4721-ae6f-7636e79a0cba"
    }
}
```
## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```text
subscription-api/
‚îú‚îÄ‚îÄ cmd/
‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îÇ       ‚îî‚îÄ‚îÄ main.go                        # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ docs.go                            # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ swagger.json                       # OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (JSON)
‚îÇ   ‚îî‚îÄ‚îÄ swagger.yaml                       # OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è (YAML)
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ server/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ server.go                  # HTTP —Å–µ—Ä–≤–µ—Ä –∏ —Ä–æ—É—Ç–∏–Ω–≥
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ handler.go             # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è http —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤ 
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ healthcheck.go         # Healthcheck —Ä–æ—É—Ç 
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ subscriptions.go       # –†–æ—É—Ç—ã –¥–ª—è –ø–æ–¥–ø–∏—Å–æ–∫
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ app.go                     # –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è http —Å–µ—Ä–≤–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ middleware/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ loggerMiddleware.go            # Middleware –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ 
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ panicMiddleware.go             # Middleware –¥–ª—è –æ—Ç–ª–æ–≤–∞ –ø–∞–Ω–∏–∫ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫)
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ migration.go                       # –ü—Ä–æ—Å—Ç–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ schema.sql                         # –°—Ö–µ–º–∞ –º–∏–≥—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ pkg/
‚îÇ   ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.go                      # –ö–æ–Ω—Ñ–∏–≥
‚îÇ   ‚îú‚îÄ‚îÄ constants/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ constants.go                   # –°—Ç—Ä–æ–∫–æ–≤—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repository/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ postgres.go                # –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î PostgreSQL
‚îÇ   ‚îú‚îÄ‚îÄ logger/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.go                  # –ö–∞—Å—Ç–æ–º–Ω—ã–π –ª–æ–≥–≥–µ—Ä
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger.go                      # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ª–æ–≥–≥–µ—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ models.go                      # DTO, –º–æ–¥–µ–ª–∏ –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ tools/
‚îÇ       ‚îî‚îÄ‚îÄ tools.go                       # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îú‚îÄ‚îÄ compose.yaml                           # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile                             # Dockerfile
‚îú‚îÄ‚îÄ .env                                   # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ go.mod                                 # Go –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ go.sum                                 # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md                              # –≠—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```
## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
#### –î–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º .env —Ñ–∞–π–ª –≤ –∫–æ—Ä–Ω–µ (–Ω–∏–∂–µ –ø—Ä–∏–º–µ—Ä)
```text
SERVER_PORT=11682
SERVER_IP=0.0.0.0
PG_USER=postgres
PG_PASSWORD=postgres
PG_HOST=postgres
PG_PORT=5432
PG_DATABASE=aggregation
LOGGER=INFO
```
## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
### Swagger UI
#### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –∞–¥—Ä–µ—Å—É:
```text 
http://localhost:11682/swagger/index.html
```
### OpenAPI —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- JSON: ```http://localhost:11682/swagger/doc.json```
- YAML: ```http://localhost:11682/swagger/doc.yaml```

## üìä –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
### –ü—Ä–∏–º–µ—Ä –ø–æ–¥–ø–∏—Å–∫–∏
```json
{
    "user_id": "60601fee-2bf1-4721-ae6f-7636e79a0cba",
    "service_name": "Yandex Plus",
    "price": 400,
    "start_date": "01-2026",
    "end_date": "12-2026",
    "created_at": "2026-01-15T10:30:00Z",
    "updated_at": "2026-01-15T10:30:00Z"
}
```
### –û—Ç–≤–µ—Ç –Ω–∞ –ø–æ–¥—Å—á–µ—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤
```json
{
    "success": true,
    "total": 2000,
    "currency": "RUB",
    "period": {
        "start_month": "01-2025",
        "end_month": "12-2026"
    },
    "filters": {
        "user_id": "60601fee-2bf1-4721-ae6f-7636e79a0cba",
        "service_name": "Yandex Plus"
    }
}
```
